<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>{% if level %}Edit Level{% else %}Add Level{% endif %}</title>
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            const groupSelect = document.getElementById('id_group');
            const preSelect = document.getElementById('id_pre');

            // Function to toggle fields based on selection
            function toggleFields() {
                if (groupSelect.value) {
                    preSelect.disabled = true;  // Disable pre if a group is selected
                } else {
                    preSelect.disabled = false;  // Enable pre if no group is selected
                }

                if (preSelect.value) {
                    groupSelect.disabled = true;  // Disable group if a pre is selected
                } else {
                    groupSelect.disabled = false;  // Enable group if no pre is selected
                }
            }

            // Initial check
            toggleFields();

            // Add event listeners to both selects
            groupSelect.addEventListener('change', toggleFields);
            preSelect.addEventListener('change', toggleFields);
        });
    </script>
</head>
<body>
    <h1>{% if level %}Edit Level{% else %}Add Level{% endif %}</h1>
    
    <form method="post">
        {% csrf_token %}
        
        <!-- Display form non-field errors -->
        {% if form.non_field_errors %}
            <div class="error">
                {{ form.non_field_errors }}
            </div>
        {% endif %}
        
        <p>
            {{ form.level_title.label_tag }}  <!-- Renders the label for level_title -->
            {{ form.level_title }}  <!-- Renders the input for level_title -->
            <!-- Display field-specific errors -->
            {% if form.level_title.errors %}
                <div class="error">{{ form.level_title.errors }}</div>
            {% endif %}
        </p>
        <p>
            {{ form.group.label_tag }}  <!-- Renders the label for group -->
            {{ form.group }}  <!-- Renders the input for group -->
            <!-- Display field-specific errors -->
            {% if form.group.errors %}
                <div class="error">{{ form.group.errors }}</div>
            {% endif %}
        </p>
        <p>
            {{ form.pre.label_tag }}  <!-- Renders the label for pre -->
            {{ form.pre }}  <!-- Renders the input for pre -->
            <!-- Display field-specific errors -->
            {% if form.pre.errors %}
                <div class="error">{{ form.pre.errors }}</div>
            {% endif %}
        </p>
        
        <p>Please select either a group or a pre-level:</p>
        <button type="submit">{% if level %}Update{% else %}Create{% endif %}</button>
    </form>
    <a href="{% url 'level_list' %}">Back to List</a>
</body>
</html>